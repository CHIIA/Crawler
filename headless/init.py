# encoding=utf-8
import MySQLdb
from log import logger
import re

db = MySQLdb.connect("localhost", "root", "root", "NLP", charset='utf8')
settings = {'id':None,'term':None,'startDate':None,'endDate':None}
relevant_ids = {'CHNDLY0020150114eb1f0001j', 'AFNR000020150408eb4900028', 'ASXTEX0020161208ecc8005sd', 'AUSTLN0020160504ec5500004', 'AGEE000020151124ebbp0005i', 'CAIRPO0020140304ea3400001', 'LBA0000020140602ea62001v7', 'TWAU000020151112ebbd0003s', 'FSTOCL0020140219ea2k00010', 'AUSTLN0020151120ebbl0006d', 'KALGOO0020140613ea6e0000i', 'LBA0000020140611ea6b000bb', 'DJTGMS1120141212eacc0000c', 'FEXANP0020151121ebbm0001t', 'IPF0000020140711ea6b00004', 'AFNR000020140612ea6d00028', 'AGEE000020160524ec5p0005a', 'DJDN000020141212eacb0002t', 'NKRP000020140520ea5j0000d', 'DEALNEW020151116ebb900013', 'AFNR000020161006eca70000m', 'WABN000020150417eb4h00105', 'AFNR000020151113ebbe0000q', 'AFNR000020151110ebbb0001d', 'LBA0000020151108ebb800mm1', 'COUMAI0020160414ec4f0000z', 'NBSPEC0020151122ebbn0002t', 'SYRANA0020160721ec7l000b5', 'ABNENG0020160427ec4r0002t', 'AAPFIN0020141124eabo000b5', 'AUSTLN0020150113eb1e0001x', 'GCBULL0020150413eb4e0002c', 'AUSTLN0020140615ea6g00043', 'GCBULL0020160602ec630002u', 'NLAUSW0020160502ec52000gq', 'MIBMED0020141125eabo00008', 'WABN000020151124ebbn0000b', 'INVWK00020160429ec4t000rn', 'NLAUSW0020140613ea6d0005o', 'NKRP000020161026ecaq0000b', 'SNLMMDW020140226ea2l00010', 'WSJO000020140612ea6b000gt', 'AUSTLN0020170104ed150001k', 'NBSPEC0020151106ebb700209', 'SNLFE00020150731eb4c006f3', 'WABN000020151105ebb50015p', 'WHITGA0020151004eba50000y', 'LBA0000020140613ea6d007n1', 'AUSTLN0020151118ebbj0000d', 'SNLFE00020161122ecbk0002t', 'AUSTLN0020150527eb5s0000o', 'HERSUN0020151109ebba00049', 'ASXTEX0020161211eccc0009b', 'AUSTLN0020140605ea6600030', 'AUSTLN0020141107eab80005m', 'HERWEK0020150818eb8j0004k', 'KALGOO0020161121ecbm0000r', 'AUSTLN0020151115ebbg00022', 'ABCNEW0020140521ea5l000gq', 'AFNR000020160629ec6u0001d', 'DAMONL0020160608ec680035x', 'GCBULL0020161130ecc10004v', 'AUSTLN0020140518ea5j00063', 'CHWKNW0020160426ec4q0007i', 'BUINPR0020151124ebbo000jh', 'AFNR000020160425ec4q0001y', 'AFNR000020140324ea3p0000b', 'GCBULL0020161016ecah00082', 'GCBULL0020140131ea210008d', 'AUSTLN0020160720ec7l0005u', 'SNLFE00020160528ec5q00002', 'COUMAI0020150108eb190000u', 'SNLMMDE020160630ec6t0000k', 'RTNW000020151109ebb900017', 'AFNR000020161102ecb30001q', 'AFNR000020150428eb4t00013', 'AFNR000020140602ea630000k', 'NBOZEN0020140302ea3200001', 'AFNR000020150421eb4m0001w', 'AAPFIN0020140613ea6d000rt', 'PARALL0020151123ebbn0002p', 'KALGOO0020161123ecbo00008', 'AFNR000020140528ea5t0002e', 'COUMAI0020140613ea6e0003r', 'AUSTLN0020160421ec4m0004a', 'AUSTLN0020141125eabq0003x', 'SMHH000020140613ea6e0004u', 'TWAU000020140603ea640000e', 'LBA0000020160419ec4j025mi', 'AAPFIN0020140310ea3a0030e', 'PLATT00020151109ebb80002t', 'LNGDAILY20151119ebb50000j', 'AFNR000020140305ea360003p', 'RECHGE0020161125ec4i0002x', 'AUSTLN0020141203eac40006e', 'WGI0000020170721ed6l00006', 'FBORDM0020141106eab700003', 'AFNR000020150929eb9u0000t', 'AUSTLN0020140612ea6d00054', 'AGEE000020150820eb8m00005', 'COUMAI0020160602ec630002u', 'GCBULL0020140407ea480004k', 'FSTOCJ0020150819eb8k0000y', 'KALGOO0020160525ec5q0000d', 'HERWEK0020140204ea250000o', 'WABN000020140304ea34000um', 'AFNR000020161114ecbf0000e', 'AFNR000020151103ebb400008', 'AUSTLN0020160422ec4n000d7', 'AFNR000020160526ec5r0000v', 'AFNR000020140220ea2l00023', 'PON0000020151209ebbb00003', 'DJDN000020140613ea6d000u5', 'AUSTLN0020151104ebb500027', 'ASXTEX0020161023ecao0012y', 'TWAU000020140430ea5100001', 'AFNR000020140307ea380004k', 'MRCURY0020151111ebbb0001q', 'AUSTLN0020141210eacb00021', 'AFNR000020160420ec4l00011', 'ADVTSR0020141126eabr0000s', 'PORDOU0020150408eb4900018', 'DJDN000020140811ea8b003pv', 'WABN000020160419ec4k000xd', 'TWAU000020150113eb1e0002g', 'SNLFE00020160507ec5500001', 'AFNR000020160418ec4j00004', 'AUSTOL0020160505ec55001ng', 'MENAFI0020151110ebb9000lq', 'COUMAI0020140228ea3100067', 'PARALL0020151103ebb3000jw', 'AUSTLN0020151123ebbo0003n', 'AFNR000020141111eabc0001o', 'AUSTLN0020160601ec6200031', 'AFNR000020141020eaal0002n', 'AUSTLN0020150113eb1e0002x', 'FWARST0020140221ea2m00011', 'AUSTLN0020140224ea2p00057', 'WABN000020150820eb8k000dx', 'AUSTLN0020141120eabl0002d', 'ADVTSR0020140310ea3b0003m', 'AFNR000020141103eab400022', 'AFNR000020140615ea6g0000u', 'TWAU000020140613ea6e00002', 'AUSTLN0020150513eb5e00005', 'AUSTLN0020141105eab60002j', 'AFNR000020151129ebbu0002n', 'AUSTLN0020141104eab50000w', 'NLDEVG0020151110ebbb0000a', 'AUSTLN0020160502ec53000ag', 'AUSTLN0020141106eab700033', 'GCBULL0020160720ec7l00041', 'AFNR000020150429eb4u0002a', 'ABCNEW0020140520ea5k00004', 'AUSTLN0020150113eb1e0000i', 'AUSTLN0020140605ea6600040', 'WABN000020140319ea3j000jh', 'AUSTLN0020160415ec4g0008q', 'AFNR000020151125ebbq0002v', 'AAPRAW0020150903eb94000gp', 'MAROMA0020151012ebad0000o', 'AFNR000020150118eb1j0001s', 'DAMONL0020140521ea5l001ut', 'AFNR000020140616ea6h0000c', 'AFNR000020160621ec6m0001k', 'MENEAG0020160628ec6s000bc', 'FWARST0020150520eb5l0000p', 'METLSDLY20160630ec620000k', 'AUSTOL0020151126ebbq001da', 'AFNR000020160525ec5q0000g', 'NORTHT0020151110ebbb00013', 'AUSTLN0020160504ec550001y', 'TWAU000020161120ecbl00005', 'LBA0000020151104ebb4009ey', 'AUSTLN0020150520eb5l0003b', 'AFNR000020151110ebbb0000i', 'AGEE000020150818eb8j0005u', 'GCBULL0020160531ec610000f', 'LBA0000020140618ea6i000gr', 'AFNR000020150414eb4f0000r', 'SNLMMDW020161125ecbo0000c', 'AFNR000020160722ec7n0000j', 'MTPW000020160503ec5300338', 'AFNR000020151111ebbc0001j', 'COUMAI0020140616ea6h0000n', 'AUSTLN0020150421eb4m00062', 'ABCNEW0020141024eaao000ci', 'AUSTLN0020150819eb8k00003', 'AFNR000020150513eb5e0000a', 'HERBRE0020140226ea2q0000k', 'AUSTOL0020151112ebbc001ez', 'FFARMW0020160601ec620000w', 'AFNR000020150408eb490002d', 'AUSTLN0020140310ea3b0002a', 'WDAN000020161214ecce0000q', 'AUSTLN0020140521ea5m0001q', 'AUSTLN0020151109ebba0003l', 'BDU0000020150127eb1r0000w', 'AUSTLN0020140212ea2d0002n', 'TWAU000020140611ea6c0000a', 'FTLAND0020150819eb8k00028', 'TWAU000020160502ec5300093', 'AUSTLN0020140519ea5k00009', 'AUSTLN0020161214eccf0001f', 'AUSTOL0020150819eb8j001ax', 'AAPRAW0020140611ea6c0028l', 'TWAU000020140109ea1a00008', 'GCPERD0020141125eabp00006', 'FUSMED0020140227ea2r0030h', 'LBA0000020150126eb1q0040v', 'SMHH000020151110ebbb0004r', 'CTM0000020140416ea4h0000l', 'AFNR000020151122ebbn0000f', 'GCPERD0020151110ebb900002', 'AAPFIN0020151108ebb9001jl', 'PARALL0020151115ebbf0000z', 'INGS000020151130ebbg00008', 'AGEE000020140530ea5v0004e', 'TWAU000020160419ec4k0002w', 'HERSUN0020160415ec4g000ci', 'AUSTLN0020151123ebbo0002o', 'NLNEWW0020150121eb1l000gr', 'NORTHT0020161106ecb50001k', 'KALGOO0020161123ecbo00005', 'DCOAL00020140321ea3i00008', 'AGEE000020151006eba70003e', 'ASXTEX0020140818ea8i0004d', 'NEHR000020151121ebbk0000h', 'ASXTEX0020161021ecal009hp', 'SNLMMDE020140314ea3b0000x', 'AFNR000020150820eb8l0003l', 'DJDN000020140612ea6c00079', 'AAPRAW0020140601ea62000gq', 'AFNR000020151115ebbg0000h', 'GCBULL0020150823eb8o0005w', 'MANAVG0020151109ebb9000e0', 'AFNR000020151123ebbo0000u', 'AGEE000020160426ec4r00051', 'WABN000020151109ebb900001', 'AUSTOL0020151012ebac0016b', 'STEELDLY20140625ea6b00024', 'WSJO000020151109ebb90038p', 'DJDN000020151109ebb9004ad', 'LBA0000020140613ea6d0073q', 'FTCOM00020141212eacc0008d', 'AFNR000020151112ebbd0000o', 'AUSTLN0020140611ea6c0002l', 'MRCURY0020160416ec4h0000w', 'AFNR000020151112ebbd00020', 'ADVTSR0020140203ea24000cr', 'AFNR000020151116ebbh0000u', 'ASXTEX0020140519ea5j00065', 'SMHH000020160429ec4u00061', 'AUSTLN0020140203ea240002a', 'AFNR000020151116ebbh0000l', 'TWAU000020160601ec620003x', 'AAPRAW0020140519ea5j0002u', 'AFNR000020151110ebbb0002d', 'OLNGAS0020151123ebbg00016', 'GCBULL0020150818eb8j0007d', 'AUSTLN0020150824eb8p0002q', 'AGEE000020151117ebbi0004r', 'AUSTLN0020150419eb4k0000t', 'AFNR000020151109ebba00012', 'AFNR000020150421eb4m0000v', 'AFNR000020161208ecc90000x', 'AUSTLN0020160523ec5o0000i', 'NLAUSW0020141223eacn000gt', 'AUSTLN0020141112eabd0003i', 'AUSTLN0020160417ec4i00023', 'AFNR000020150401eb4200015', 'AFNR000020140223ea2o00025', 'MYPAPR0020160616ec6f0000i', 'DAMONL0020161123ecbn002uu', 'SMHH000020141114eabf00016', 'NBSPEC0020151109ebba002ea', 'TMRTPL0020141024eaan0000p', 'AFNR000020160525ec5q0000c', 'AFNR000020151117ebbi00004', 'GCBULL0020160714ec7f0002p', 'NBSPEC0020151122ebbn0008d', 'AUSTLN0020151112ebbd0001g', 'DJDN000020160418ec4i001th', 'AUSTLN0020161006eca70002m', 'AUSTLN0020150118eb1j0001u', 'AAPRAW0020140317ea3i002gx', 'AFNR000020140217ea2i0000n', 'WABN000020161123ecbo000rt', 'AFNR000020140219ea2k00001', 'SNLMMDW020140603ea5t0000p', 'DAMONL0020160415ec4f00105', 'AFNR000020140518ea5j0000e', 'AUSTLN0020150513eb5e0000m', 'GCBULL0020140615ea6e0002j', 'RESNEW0020161116ecbg00001', 'AUSTLN0020160713ec7e00007', 'FVICTH0020150819eb8k00010', 'SMHH000020151113ebbe0005y', 'ASXTEX0020140617ea6h0004p', 'MIBMED0020140305ea340000e', 'NORTHT0020151111ebbc00008', 'GCBULL0020170808ed890000c', 'LBA0000020160614ec6e0058y', 'AFNR000020140129ea1u0002q', 'AUSTLN0020160629ec6u0000n', 'SNLMMDE020160505ec5400005', 'AFNR000020160415ec4g0001h', 'AUSTLN0020151130ebc10000f', 'TDAYSG0020151119ebbk0003j', 'AFNR000020151115ebbg0000m', 'FEDENM0020151001eb9u00007', 'STSCNW0020161222eccf0000m', 'FTLAND0020140521ea5m0002m', 'AGEE000020140617ea6i0004y', 'COUMAI0020150122eb1n0000b', 'NLAUSW0020140529ea5t0002t', 'AFNR000020151105ebb60000a', 'AFNR000020160703ec740000r', 'LBA0000020150602eb6200cth', 'AUSTLN0020140519ea5k0002h', 'COUMAI0020151109ebba00010', 'LBA0000020140620ea6k002jp', 'DJDN000020141117eabh003ub', 'GCBULL0020141022eaam0001u', 'PLATT00020151124ebbo000dy', 'BTMAL00020160503ec4u0000g', 'AUSTLN0020140530ea5v0006v', 'CANBTZ0020141022eaan00011', 'ACQIND0020150121eb1k0000c', 'SNLFE00020161123ecbl00002', 'BBPUB00020141123eabn0002v', 'GCBULL0020140605ea660000f', 'SCCPB00020141204eac400002', 'COUMAI0020150407eb480000s', 'HERWEK0020140520ea5l00034', 'KALGOO0020140521ea5m00009', 'ABCNEW0020141030eaau0008r', 'GEEADV0020140218ea2j0003k', 'AGEE000020150929eb9u0004u', 'TWAU000020151123ebbo0003o', 'AGEE000020151110ebbb00022', 'MENREP0020140414ea4e001sw', 'REAP000020141120eabh00002', 'ABCNEW0020160421ec4l0006b', 'DJDN000020140611ea6b0015c', 'REWKN00020150206eb2d00002', 'AUSTOL0020161219ecbs0028f', 'COUMAI0020141124eabp0001z', 'AUSTLN0020151109ebba00016', 'SCCPB00020161018ecai00001', 'AUSTLN0020150930eba10002z', 'AUSTLN0020150526eb5r00022', 'AFNR000020141120eabl00008', 'AFNR000020150116eb1f00002', 'ADPREN0020160418ec4i000gp', 'MPCOUN0020140210ea2b0000o', 'AFNR000020150819eb8k0000r', 'AFNR000020140312ea3d00029', 'BBPUB00020140312ea3c00001', 'AAP0000020160420ec4k001rz', 'AAPFIN0020140616ea6g000ul', 'GCBULL0020140612ea6d0000j', 'MOODPR0020141212eacc000rt', 'NEHR000020151122ebbl0000j', 'JPSTEN0020161020ecak001xi', 'AUSTLN0020151112ebbd0000d', 'TWAU000020140316ea3h0000z', 'ABNENG0020140619ea6j0002t', 'AFNR000020140618ea6j0005t', 'AUSTLN0020141119eabk0003t', 'AUSTLN0020151120ebbl0005m', 'NBSPEC0020151123ebbo001gw', 'BDU0000020141118eabi0000x', 'SMHH000020151117ebbi0005t', 'AUSTLN0020150929eb9u0002j', 'AUSTLN0020140204ea250003j', 'FMARUW0020161129ecbu0000g', 'AGEE000020161011ecac0004k', 'AFNR000020140611ea6c0000j', 'AGEE000020151120ebbl00067', 'AFNR000020160601ec6200026', 'AUSTLN0020150331eb410000e', 'FSTOCL0020150618eb5l000l8', 'AUSTLN0020161130ecc10000z', 'AFNR000020151011ebac00006', 'NBSPEC0020151123ebbo0015s', 'DJDN000020140613ea6d000nf', 'AFNR000020151122ebbn0001j', 'ACQIND0020160420ec4k0000j', 'AUSTLN0020141225eacq00027', 'AUSTLN0020160720ec7l0006m', 'TWAU000020141209eaca00030', 'AUSTLN0020160629ec6u0000j', 'AUSTLN0020150422eb4n0002w', 'AFNR000020140309ea3a0000k', 'AFNR000020140616ea6h00010', 'TWAU000020140218ea2j00021', 'AAPRAW0020160602ec620008h', 'CTM0000020141210eacb0000v', 'AWSJ000020140615ea6g00017', 'ASXTEX0020140804ea84000a8', 'AUSTLN0020151111ebbc0008h', 'AFNR000020160523ec5o0000d', 'AUSTLN0020160504ec5500044', 'AUSTOL0020160526ec5q001z2', 'AFNR000020140615ea6g0000d', 'AFNR000020160502ec520000o', 'AFNR000020140518ea5j0000h', 'FTFT000020141224eaco00027', 'SMACOM0020140203ea2300001', 'AUSTLN0020160427ec4s0003v', 'AGEE000020151122ebbn0002e', 'SNLMMDW020141128eabp00006', 'MENAFI0020150207eb260006m', 'SMHH000020150929eb9u00053', 'AFNR000020141112eabd0000s', 'KALGOO0020141209eaca0000n', 'AFPR000020140430ea4u0046a', 'DAITEL0020150820eb8l0004i', 'FSTOCJ0020151118ebbj00016', 'ASXTEX0020161222eccn00ga5', 'AFNR000020160418ec4j0001g', 'AFNR000020151116ebbh0001s', 'AFNR000020140519ea5k0000r', 'AUSTLN0020161102ecb300034', 'SNLFE00020151114ebbc00002', 'AUSTLN0020151120ebbl00053', 'NBSPEC0020151108ebb9000jh', 'AGEE000020141024eaap0006j', 'AUSTLN0020141105eab60003e', 'HERSUN0020151109ebba0005g', 'PTGOLD0020150114eb1e000gp', 'HERSUN0020160415ec4g000ba', 'MENREP0020140529ea5t00495', 'ADVTSR0020140525ea5q0008l', 'ANNT000020170302ec54001g3', 'REAP000020151117ebbg00001', 'KALGOO0020150820eb8l0000g', 'AFNR000020151108ebb90001v', 'SNLMMDE020161011ecaa0000n', 'TWAU000020140309ea3a00003', 'STEELDLY20140325ea3b0000y', 'ABCNEW0020140319ea3j000ba', 'XNEWS00020150408eb48003mm', 'NLAUSW0020151013ebad0005m', 'TWAU000020151103ebb40006f', 'AUSTLN0020151113ebbe0002x', 'AUSTLN0020140113ea1e00023', 'PRN0000020150528eb5s00043', 'AFNR000020151007eba80002k', 'AUSTLN0020151111ebbc0001p', 'SHD0000020151121ebbm0002c', 'AGEE000020140620ea6l0003n', 'AGEE000020141118eabj00029', 'SHD0000020151107ebb80000t', 'PLATT00020140423ea4n0008d', 'INVEST0020160527ec5r0002u', 'SNLFE00020150731eb1i000w1', 'NEHR000020141221eack0000l', 'AFNR000020150818eb8j00007', 'AUSTLN0020160712ec7d00007', 'AUSTOL0020151124ebbo0018o', 'SMHH000020151108ebb90001o', 'NORDIS0020161012ecac0002c', 'AGEE000020150428eb4t0005a', 'AFNR000020160710ec7b0001y', 'KALGOO0020140617ea6i0000p', 'SNLFE00020160420ec4i0002u', 'AFNR000020141107eab800015', 'AFNR000020140620ea6l0003j', 'FTLAND0020151217ea5l000ys', 'TWAU000020140602ea6200001', 'ADVTSR0020150103eb130005k', 'AFNR000020160418ec4j0000c', 'AUSTLN0020140521ea5m00017', 'AUSTLN0020151122ebbn0000y', 'NLAUSW0020140616ea6g000mf', 'SNLFE00020151111ebb90002t', 'LIVLEA0020161012ecac00017', 'CDUSDE0020151124ebbo0000g', 'TWAU000020151109ebba00049', 'HERWEK0020150526eb5r0006b', 'AFNR000020141205eac60001j', 'SNLFE00020151114ebbc0002t', 'NBSPEC0020151104ebb5002jp', 'AFNR000020141026eaar0000e', 'KALGOO0020140604ea650000d', 'TWAU000020160425ec4q0003r', 'FABURN0020141230eacv0001e', 'METLSDLY20151203ebb500006', 'AUSTLN0020161108ecb90002j', 'CTM0000020161012ecad0000q', 'PRIEST0020151124ebbo00003', 'AFNR000020151111ebbc00019', 'AFNR000020161019ecak0000p', 'NBOZEN0020140314ea3e0002t', 'AFNR000020150101eb120001h', 'AFNR000020141114eabf0000u', 'NORSHO0020160414ec4f0000j', 'AUSTLN0020140618ea6j0000b', 'ENPNEW0020150422eb4m000hc', 'AUSTLN0020160610ec6b00077', 'EDGEWK0020140528ea5q0000f', 'IOD0000020140610ea6300004', 'MENREP0020140526ea5q004lx', 'CHNDLY0020140611ea6c0000j', 'AFNR000020150429eb4u0001m', 'AGEE000020150505eb560005e', 'AFNR000020140527ea5s0002k', 'COUMAI0020140612ea6d000yp', 'AUSTLN0020140326ea3r0003d', 'AUSTLN0020141023eaao0000y', 'SNLMMDE020150601eb5r0000q', 'AGEE000020150505eb5600052', 'AFNR000020140610ea6b0002m', 'AFNR000020150819eb8k0001s', 'AFNR000020150115eb1g0001n', 'NBSPEC0020151109ebb90005o', 'AUSTLN0020160529ec5u0002b', 'STEELDLY20140616ea620001d'}

sql = "SELECT ID from NLP_ARTICLE where date>='2014-01-01' and date<'2017-01-01'"
cursor = db.cursor()
cursor.execute(sql)
articles = cursor.fetchall()

for article in articles:
	id = article[0]
	if id in relevant_ids:
		status = 1
		sql = "UPDATE NLP_ARTICLE SET status = {} ,labeledby='System' ,labeledtime='2018-10-01', likelyhood=1  WHERE ID = '{}'".format(status, id)

	else:
	        status = 2
		sql = "UPDATE NLP_ARTICLE SET status = {} ,labeledby='System' ,labeledtime='2018-10-01', likelyhood=0  WHERE ID = '{}'".format(status, id)
	cursor.execute(sql)
	db.commit()
